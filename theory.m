clc
clear
e1=3.4;
e3=1;
e4=5;
e= 2.71828;
g=0.4e-3;
e0=8.854187817*1e-12;
w=0.4e-3;
h1=2.5e-5;
h2=11e-5;
h3=10e-5;
l=0.5*(g+w);
Vp=5000;
i=0;
e2v=1:1:30;
s=l;
for e2=e2v
    i=i+1;
%     Vm=(5000 - (2820000*e4 + e2*(13590000*e4^3 + 28030000*e4^2 + 17285000*e4 + 2820000) + (e2.^3)*(5130000*e4^3 + 14490000*e4^2 + 13590000*e4 + 4230000) + (e2.^2)*(14490000*e4^3 + 35587500*e4^2 + 28030000*e4 + 6932500) + 6932500*e4^2 + 4230000*e4^3)./(1128*e4 + e2.*(5436*e4^3 + 11212*e4^2 + 6914*e4 + 1128) + e2.^4*(255*e4^3 + 765*e4^2 + 765*e4 + 255) + e2.^3*(2562*e4^3 + 7281*e4^2 + 6876*e4 + 2157) + e2.^2*(6051*e4^3 + 14955*e4^2 + 11887*e4 + 2983) + 2773*e4^2 + 1692*e4^3));
Vm=(0.195601E16+0.69445E16.*e2+0.859436E16.*e2.^2+0.41384E16.*e2.^3+ ...
  0.5319E15.*e2.^4).^(-1).*(0.510816E19+0.181357E20.*e2+0.23681E20.* ...
  e2.^2+0.133146E20.*e2.^3+0.26595E19.*e2.^4);


for n=1:10
    
lambda=n*pi/l;

D3=2.*l.^(-1).*(l.*(Vm+Vp)+((-1).*Vm+Vp).*w);

C3=0;

G3=[8.*exp(1).^(2.*h2.*lambda).*e2.*(e3+e4).*(e2.*e3+exp(1).^(2.*h2.*lambda).* ...
  e2.*e3+exp(1).^(2.*h2.*lambda+2.*((-1).*h2+(-1).*h3).*lambda).*e2.*e3+exp(1) ...
  .^(4.*h2.*lambda+2.*((-1).*h2+(-1).*h3).*lambda).*e2.*e3+(-1).*e3.^2+exp(1) ...
  .^(2.*h2.*lambda).*e3.^2+exp(1).^(2.*h2.*lambda+2.*((-1).*h2+(-1).*h3).*lambda).* ...
  e3.^2+(-1).*exp(1).^(4.*h2.*lambda+2.*((-1).*h2+(-1).*h3).*lambda).*e3.^2+ ...
  e2.*e4+exp(1).^(2.*h2.*lambda).*e2.*e4+(-1).*exp(1).^(2.*h2.*lambda+2.*((-1) ...
  .*h2+(-1).*h3).*lambda).*e2.*e4+(-1).*exp(1).^(4.*h2.*lambda+2.*((-1).*h2+( ...
  -1).*h3).*lambda).*e2.*e4+(-1).*e3.*e4+exp(1).^(2.*h2.*lambda).*e3.*e4+(-1) ...
  .*exp(1).^(2.*h2.*lambda+2.*((-1).*h2+(-1).*h3).*lambda).*e3.*e4+exp(1).^( ...
  4.*h2.*lambda+2.*((-1).*h2+(-1).*h3).*lambda).*e3.*e4).^(-1).*n.^(-2).*pi.^( ...
  -2).*(s+(-1).*w).^(-1).*(s.*Vm+(-1).*s.*Vp+(-1).*s.*Vm.*cos(n.* ...
  pi.*s.^(-1).*(s+(-1).*w))+s.*Vp.*cos(n.*pi.*s.^(-1).*(s+(-1).*w))+ ...
  n.*pi.*s.*Vp.*sin(n.*pi)+(-1).*n.*pi.*Vp.*w.*sin(n.*pi))];

H3=[8.*exp(1).^(2.*h2.*lambda).*e2.*(exp(1).^(2.*((-1).*h2+(-1).*h3).*lambda).* ...
  e3+(-1).*exp(1).^(2.*((-1).*h2+(-1).*h3).*lambda).*e4).*(e2.*e3+exp(1) ...
  .^(2.*h2.*lambda).*e2.*e3+exp(1).^(2.*h2.*lambda+2.*((-1).*h2+(-1).*h3).*lambda) ...
  .*e2.*e3+exp(1).^(4.*h2.*lambda+2.*((-1).*h2+(-1).*h3).*lambda).*e2.*e3+(-1) ...
  .*e3.^2+exp(1).^(2.*h2.*lambda).*e3.^2+exp(1).^(2.*h2.*lambda+2.*((-1).*h2+( ...
  -1).*h3).*lambda).*e3.^2+(-1).*exp(1).^(4.*h2.*lambda+2.*((-1).*h2+(-1).*h3) ...
  .*lambda).*e3.^2+e2.*e4+exp(1).^(2.*h2.*lambda).*e2.*e4+(-1).*exp(1).^(2.* ...
  h2.*lambda+2.*((-1).*h2+(-1).*h3).*lambda).*e2.*e4+(-1).*exp(1).^(4.*h2.*lambda+ ...
  2.*((-1).*h2+(-1).*h3).*lambda).*e2.*e4+(-1).*e3.*e4+exp(1).^(2.*h2.*lambda) ...
 .*e3.*e4+(-1).*exp(1).^(2.*h2.*lambda+2.*((-1).*h2+(-1).*h3).*lambda).*e3.* ...
  e4+exp(1).^(4.*h2.*lambda+2.*((-1).*h2+(-1).*h3).*lambda).*e3.*e4).^(-1).* ...
  n.^(-2).*pi.^(-2).*(s+(-1).*w).^(-1).*(s.*Vm+(-1).*s.*Vp+(-1).*s.* ...
  Vm.*cos(n.*pi.*s.^(-1).*(s+(-1).*w))+s.*Vp.*cos(n.*pi.*s.^(-1).*( ...
  s+(-1).*w))+n.*pi.*s.*Vp.*sin(n.*pi)+(-1).*n.*pi.*Vp.*w.*sin(n.* ...
  pi))];

y=-h2-0.9*h3;
Ey=@(x)(C3+(exp(1).^(lambda.*y).*G3.*lambda+(-1).*exp(1).^((-1).*lambda.* ...
  y).*H3.*lambda).*cos(lambda.*x)).^2;
Ex=@(x)((-1).*(exp(1).^(lambda.*y).*G3+exp(1).^((-1).*lambda.*y).*H3).* ...
  lambda.*sin(lambda.*x)).^2;
Fy(n,i)=0.5*integral(Ey,0,l);
Fx(n,i)=0.5*integral(Ex,0,l);
    end
end
F=0.0264*e0*sum(-Fx.'+Fy.');
hold on 
plot(e2v,F)
